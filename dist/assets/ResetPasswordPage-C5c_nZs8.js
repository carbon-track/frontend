import{u as R,e as q,t as A,r as d,j as s,I as j,B as I,L as B,f as F,n as u}from"./index-9oiziVwF.js";import{u as D}from"./index.esm-CHdFkG8q.js";import{C as V,a as H,b as O,c as z,d as G}from"./Card-DiZzX4G1.js";import{A as b,a as v}from"./Alert-DMTWhZOi.js";import{L as J}from"./lock-zRD_BSpU.js";import{E as K}from"./eye-off-BVqitGWE.js";import{E as Q}from"./eye-QkcRAVlH.js";const y=({visible:e,onClick:m})=>s.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:m,children:e?s.jsx(K,{className:"h-4 w-4 text-gray-400"}):s.jsx(Q,{className:"h-4 w-4 text-gray-400"})});function ss(){const{t:e}=R(),m=q(),[h]=A(),l=h.get("token")||"",N=h.get("email")||"",[w,S]=d.useState(!1),[x,C]=d.useState(!1),[o,i]=d.useState(null),[c,f]=d.useState(!1),k=d.useMemo(()=>({password:"",confirmPassword:""}),[]),{register:p,handleSubmit:L,watch:E,formState:{errors:r}}=D({defaultValues:k}),T=E("password"),M=async a=>{var g,P;if(!l){i({variant:"destructive",message:e("auth.resetPassword.tokenMissing")});return}f(!0),i(null);try{const t=await F.resetPassword(l,a.password,a.confirmPassword);if(t.success)u.success(e("auth.resetPassword.success")),i({variant:"success",message:e("auth.resetPassword.success")}),setTimeout(()=>m("/auth/login"),2e3);else{const n=t.message||e("auth.resetPassword.failed");i({variant:"destructive",message:n}),u.error(n)}}catch(t){const n=((P=(g=t==null?void 0:t.response)==null?void 0:g.data)==null?void 0:P.message)||t.message||e("auth.resetPassword.failed");i({variant:"destructive",message:n}),u.error(n)}finally{f(!1)}};return s.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:s.jsxs("div",{className:"max-w-md w-full space-y-8",children:[s.jsxs("div",{className:"text-center",children:[s.jsx("div",{className:"mx-auto h-12 w-12 flex items-center justify-center rounded-full bg-green-100",children:s.jsx(J,{className:"h-6 w-6 text-green-600"})}),s.jsx("h2",{className:"mt-6 text-3xl font-extrabold text-gray-900",children:e("auth.resetPassword.newTitle")}),s.jsx("p",{className:"mt-2 text-sm text-gray-600",children:e("auth.resetPassword.newSubtitle",{email:N||e("auth.verification.yourEmail")})})]}),s.jsxs(V,{children:[s.jsxs(H,{children:[s.jsx(O,{children:e("auth.resetPassword.newTitle")}),s.jsx(z,{children:e("auth.resetPassword.instructions")})]}),s.jsxs(G,{children:[!l&&s.jsx(b,{variant:"warning",className:"mb-4",children:s.jsx(v,{children:e("auth.resetPassword.tokenMissing")})}),(o==null?void 0:o.message)&&s.jsx(b,{variant:o.variant||"info",className:"mb-4",children:s.jsx(v,{children:o.message})}),s.jsxs("form",{onSubmit:L(M),className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:e("auth.resetPassword.newPasswordLabel")}),s.jsxs("div",{className:"mt-1 relative",children:[s.jsx(j,{id:"password",type:w?"text":"password",autoComplete:"new-password",placeholder:e("auth.passwordPlaceholder"),disabled:c,error:r.password,...p("password",{required:e("auth.passwordRequired"),minLength:{value:8,message:e("auth.passwordMinLength")}})}),s.jsx(y,{visible:w,onClick:()=>S(a=>!a)}),r.password&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.password.message})]})]}),s.jsxs("div",{children:[s.jsx("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:e("auth.resetPassword.confirmPasswordLabel")}),s.jsxs("div",{className:"mt-1 relative",children:[s.jsx(j,{id:"confirmPassword",type:x?"text":"password",autoComplete:"new-password",placeholder:e("auth.confirmPasswordPlaceholder"),disabled:c,error:r.confirmPassword,...p("confirmPassword",{required:e("auth.resetPassword.confirmPasswordRequired"),validate:a=>a===T||e("auth.resetPassword.passwordMismatch")})}),s.jsx(y,{visible:x,onClick:()=>C(a=>!a)}),r.confirmPassword&&s.jsx("p",{className:"mt-1 text-sm text-red-600",children:r.confirmPassword.message})]})]}),s.jsx(I,{type:"submit",className:"w-full",disabled:c||!l,children:e(c?"auth.resetPassword.submitting":"auth.resetPassword.submit")})]}),s.jsx("div",{className:"mt-6 text-center",children:s.jsx(B,{to:"/auth/login",className:"text-sm font-medium text-green-600 hover:text-green-500",children:e("auth.backToLogin")})})]})]})]})})}export{ss as default};
