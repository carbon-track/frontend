import{c as E,u as j,j as e,M as w,B as o,X as u,l as z,r as F,f as y}from"./index-BKjOfV5l.js";import{a as B,u as O,L as Q}from"./useQuery-BKOf-XZE.js";import{u as v,n as x}from"./index-Bfck6wEh.js";import{I as q}from"./Input-CQCfPgps.js";import{F as R}from"./funnel-Ch0r0Cl2.js";import{S as V}from"./search-B4M-0oqD.js";import{E as X}from"./eye-CXemIeRw.js";import{T as S}from"./trash-2-B14U8VE0.js";import{f as A,P as Z}from"./Pagination-BlE9lgWV.js";import{C as G,a as J,b as K,d as U,c as W}from"./Card-BjV_5Hz9.js";import{A as Y,b as ee,a as se}from"./Alert-Tl0dtwbA.js";import{C as te}from"./circle-alert-IgYmallE.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M21.2 8.4c.5.38.8.97.8 1.6v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V10a2 2 0 0 1 .8-1.6l8-6a2 2 0 0 1 2.4 0l8 6Z",key:"1jhwl8"}],["path",{d:"m22 10-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 10",key:"1qfld7"}]],p=E("mail-open",ae);function le({filters:s,onFiltersChange:m,isLoading:i=!1}){const{t:a}=j(),t=(l,N)=>{m({...s,[l]:N,page:1})},d=()=>{m({search:"",type:"",status:"",priority:"",sort:"created_at_desc",page:1})},c=s.search||s.type||s.status||s.priority,r=[{value:"unread",label:a("messages.unread"),icon:e.jsx(w,{className:"h-4 w-4 text-blue-500"})},{value:"read",label:a("messages.read"),icon:e.jsx(p,{className:"h-4 w-4 text-gray-500"})}],f=[{value:"system",label:a("messages.types.system")},{value:"notification",label:a("messages.types.notification")},{value:"approval",label:a("messages.types.approval")},{value:"rejection",label:a("messages.types.rejection")},{value:"exchange",label:a("messages.types.exchange")},{value:"welcome",label:a("messages.types.welcome")},{value:"reminder",label:a("messages.types.reminder")}],b=[{value:"low",label:a("messages.priority.low")},{value:"normal",label:a("messages.priority.normal")},{value:"high",label:a("messages.priority.high")},{value:"urgent",label:a("messages.priority.urgent")}];return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(R,{className:"h-5 w-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:a("messages.filters.title")})]}),c&&e.jsxs(o,{variant:"ghost",size:"sm",onClick:d,className:"text-gray-500 hover:text-gray-700",children:[e.jsx(u,{className:"h-4 w-4 mr-1"}),a("common.clear")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("common.search")}),e.jsxs("div",{className:"relative",children:[e.jsx(V,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(q,{type:"text",value:s.search,onChange:l=>t("search",l.target.value),placeholder:a("messages.filters.searchPlaceholder"),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("messages.filters.type")}),e.jsxs("select",{value:s.type,onChange:l=>t("type",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:i,children:[e.jsx("option",{value:"",children:a("messages.filters.allTypes")}),f.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("messages.filters.status")}),e.jsxs("select",{value:s.status,onChange:l=>t("status",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:i,children:[e.jsx("option",{value:"",children:a("messages.filters.allStatus")}),r.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))]})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("messages.filters.priority")}),e.jsxs("select",{value:s.priority,onChange:l=>t("priority",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:i,children:[e.jsx("option",{value:"",children:a("messages.filters.allPriorities")}),b.map(l=>e.jsx("option",{value:l.value,children:l.label},l.value))]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("common.sort.sortBy")}),e.jsxs("select",{value:s.sort,onChange:l=>t("sort",l.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:i,children:[e.jsx("option",{value:"created_at_desc",children:a("common.sort.newest")}),e.jsx("option",{value:"created_at_asc",children:a("common.sort.oldest")}),e.jsx("option",{value:"priority_desc",children:a("messages.filters.priorityHighToLow")}),e.jsx("option",{value:"priority_asc",children:a("messages.filters.priorityLowToHigh")})]})]}),c&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-blue-700",children:[e.jsx(R,{className:"h-4 w-4"}),e.jsxs("span",{children:[a("messages.filters.activeFilters"),":"]})]})}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[s.search&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:[a("common.search"),': "',s.search,'"',e.jsx("button",{onClick:()=>t("search",""),className:"ml-1 hover:text-blue-600",children:e.jsx(u,{className:"h-3 w-3"})})]}),s.type&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:[a(`messages.types.${s.type}`),e.jsx("button",{onClick:()=>t("type",""),className:"ml-1 hover:text-blue-600",children:e.jsx(u,{className:"h-3 w-3"})})]}),s.status&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:[a(`messages.${s.status}`),e.jsx("button",{onClick:()=>t("status",""),className:"ml-1 hover:text-blue-600",children:e.jsx(u,{className:"h-3 w-3"})})]}),s.priority&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:[a(`messages.priority.${s.priority}`),e.jsx("button",{onClick:()=>t("priority",""),className:"ml-1 hover:text-blue-600",children:e.jsx(u,{className:"h-3 w-3"})})]})]})]})]})}function re({messages:s,onRowClick:m,onMarkRead:i,onDelete:a}){const{t}=j(),d=r=>r==="read"?e.jsx(p,{className:"h-4 w-4 text-gray-500"}):e.jsx(w,{className:"h-4 w-4 text-blue-500"}),c=r=>{switch(r){case"low":return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:t("messages.priority.low")});case"normal":return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:t("messages.priority.normal")});case"high":return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:t("messages.priority.high")});case"urgent":return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:t("messages.priority.urgent")});default:return null}};return e.jsx("div",{className:"overflow-x-auto bg-white rounded-lg shadow-sm border",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("messages.types.title")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("messages.priority.title")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("messages.subject")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("messages.status")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("messages.date")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:t("common.actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(r=>e.jsxs("tr",{className:`hover:bg-gray-50 ${r.status==="unread"?"bg-blue-50":""}`,children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[d(r.status),e.jsx("span",{className:"ml-2 text-sm font-medium text-gray-900",children:t(`messages.types.${r.type}`,r.type)})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:c(r.priority)}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900 line-clamp-1",children:r.subject})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:t(`messages.${r.status}`)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:A(new Date(r.created_at),"yyyy-MM-dd HH:mm")}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>m(r),className:"mr-2",children:[e.jsx(X,{className:"h-4 w-4 mr-1"})," ",t("common.view")]}),r.status==="unread"&&e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>i(r.id),className:"mr-2",children:[e.jsx(p,{className:"h-4 w-4 mr-1"})," ",t("messages.markRead")]}),e.jsxs(o,{variant:"ghost",size:"sm",onClick:()=>a(r.id),className:"text-red-600 hover:text-red-800",children:[e.jsx(S,{className:"h-4 w-4 mr-1"})," ",t("common.delete")]})]})]},r.id))})]})})}function ne({message:s,isOpen:m,onClose:i,onMarkRead:a}){const{t}=j();if(!m||!s)return null;const d=r=>r==="read"?e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:[e.jsx(p,{className:"h-3 w-3 mr-1"})," ",t("messages.read")]}):e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.jsx(w,{className:"h-3 w-3 mr-1"})," ",t("messages.unread")]}),c=r=>{switch(r){case"low":return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:t("messages.priority.low")});case"normal":return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:t("messages.priority.normal")});case"high":return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:t("messages.priority.high")});case"urgent":return e.jsx("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:t("messages.priority.urgent")});default:return null}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs(G,{className:"border-0 shadow-none",children:[e.jsxs(J,{className:"flex flex-row items-center justify-between space-y-0 pb-4",children:[e.jsxs("div",{children:[e.jsx(K,{className:"text-xl",children:t("messages.detail.title")}),e.jsx(U,{children:t("messages.detail.subtitle")})]}),e.jsx(o,{variant:"ghost",size:"sm",onClick:i,className:"h-8 w-8 p-0",children:e.jsx(u,{className:"h-4 w-4"})})]}),e.jsxs(W,{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:t("messages.type")}),e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:t(`messages.types.${s.type}`,s.type)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:t("messages.status")}),d(s.status)]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:t("messages.priority.title")}),c(s.priority)]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:t("messages.date")}),e.jsx("p",{className:"text-gray-900",children:A(new Date(s.created_at),"yyyy-MM-dd HH:mm")})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-md font-semibold text-gray-700 mb-2 flex items-center",children:[e.jsx(z,{className:"h-4 w-4 mr-2"}),t("messages.subject")]}),e.jsx("p",{className:"text-gray-900 bg-gray-50 p-3 rounded-md",children:s.subject})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-md font-semibold text-gray-700 mb-2 flex items-center",children:[e.jsx(Info,{className:"h-4 w-4 mr-2"}),t("messages.content")]}),e.jsx("div",{className:"text-gray-700 bg-gray-50 p-3 rounded-md",dangerouslySetInnerHTML:{__html:s.content}})]}),e.jsxs("div",{className:"flex justify-end pt-4",children:[s.status==="unread"&&e.jsxs(o,{variant:"outline",onClick:()=>a(s.id),className:"mr-2",children:[e.jsx(p,{className:"h-4 w-4 mr-1"})," ",t("messages.markRead")]}),e.jsx(o,{onClick:i,children:t("common.close")})]})]})]})})})}function fe(){var M,_;const{t:s}=j(),m=B(),[i,a]=F.useState({search:"",type:"",status:"",priority:"",sort:"created_at_desc",page:1,limit:10}),[t,d]=F.useState(null),{data:c,isLoading:r,error:f,isFetching:b}=O(["messages",i],()=>y.get("/messages",{params:i}),{keepPreviousData:!0}),l=v(n=>y.put(`/messages/${n}/read`),{onSuccess:()=>{m.invalidateQueries("messages"),x.success(s("messages.markReadSuccess")),t&&d(n=>({...n,status:"read"}))},onError:()=>{x.error(s("messages.markReadFailed"))}}),N=v(n=>y.delete(`/messages/${n}`),{onSuccess:()=>{m.invalidateQueries("messages"),x.success(s("messages.deleteSuccess")),d(null)},onError:()=>{x.error(s("messages.deleteFailed"))}}),k=v(()=>y.put("/messages/mark-all-read"),{onSuccess:()=>{m.invalidateQueries("messages"),x.success(s("messages.markAllReadSuccess"))},onError:()=>{x.error(s("messages.markAllReadFailed"))}}),P=n=>{a(n)},D=n=>{a(L=>({...L,page:n}))},H=n=>{d(n),n.status==="unread"&&l.mutate(n.id)},T=()=>{d(null)},C=n=>{l.mutate(n)},$=n=>{window.confirm(s("messages.confirmDelete"))&&N.mutate(n)},I=()=>{window.confirm(s("messages.confirmMarkAllRead"))&&k.mutate()},h=((M=c==null?void 0:c.data)==null?void 0:M.data)||[],g=((_=c==null?void 0:c.data)==null?void 0:_.pagination)||{};return e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:s("messages.title")}),e.jsx("p",{className:"text-muted-foreground",children:s("messages.subtitle")})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(o,{variant:"outline",onClick:I,disabled:k.isLoading||h.filter(n=>n.status==="unread").length===0,children:[e.jsx(p,{className:"h-4 w-4 mr-2"})," ",s("messages.markAllRead")]}),e.jsxs(o,{variant:"destructive",onClick:()=>{window.confirm(s("messages.confirmDeleteAll"))&&x.error(s("messages.deleteAllNotImplemented"))},disabled:h.length===0,children:[e.jsx(S,{className:"h-4 w-4 mr-2"})," ",s("messages.deleteAll")]})]})]}),e.jsx(le,{filters:i,onFiltersChange:P,isLoading:b}),r?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(Q,{className:"h-8 w-8 animate-spin text-green-500"})}):f?e.jsxs(Y,{variant:"destructive",children:[e.jsx(te,{className:"h-4 w-4"}),e.jsx(ee,{children:s("common.error")}),e.jsx(se,{children:s("errors.loadFailed")})]}):h.length===0?e.jsxs("div",{className:"text-center py-16 bg-white rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-xl font-semibold",children:s("messages.noMessagesFound")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s("messages.tryDifferentFilters")})]}):e.jsxs(e.Fragment,{children:[e.jsx(re,{messages:h,onRowClick:H,onMarkRead:C,onDelete:$}),e.jsx(Z,{currentPage:g.current_page,totalPages:g.total_pages,onPageChange:D,itemsPerPage:g.per_page,totalItems:g.total_items})]}),e.jsx(ne,{message:t,isOpen:!!t,onClose:T,onMarkRead:C})]})}export{fe as default};
