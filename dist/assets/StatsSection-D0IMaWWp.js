import{u as b,E as N,r as m,j as a,a6 as f}from"./index-DwFiEGTX.js";const o=["text-green-600","text-blue-600","text-purple-600","text-orange-600"],j=new Intl.NumberFormat,y=new Intl.NumberFormat(void 0,{notation:"compact",maximumFractionDigits:1}),u=new Intl.NumberFormat(void 0,{maximumFractionDigits:2}),c=e=>j.format(Math.max(0,Math.round(e||0))),d=e=>y.format(Math.max(0,e||0)),x=(e,s)=>{const r=Number(e||0);return r>=1e3?`${u.format(r/1e3)} ${s("units.t")}`:`${u.format(r)} ${s("units.kg")}`};function w(){const{t:e}=b(),{data:s,isLoading:r,isError:l}=N(["public-stats-summary"],async()=>{var n;return((n=(await f.getPublicSummary()).data)==null?void 0:n.data)??{}},{staleTime:6e4,refetchOnWindowFocus:!1}),g=m.useMemo(()=>{const t=s||{};return[{key:"users",label:e("home.stats.users"),value:d(t.total_users??0),accent:o[0],detail:e("home.stats.newUsers30d",{value:c(t.new_users_30d??0)})},{key:"records",label:e("home.stats.activities"),value:d(t.total_records??0),accent:o[1],detail:e("home.stats.approvedRecords",{value:c(t.approved_records??0)})},{key:"carbon",label:e("home.stats.carbonSaved"),value:x(t.total_carbon_saved??0,e),accent:o[2],detail:e("home.stats.carbonLast7Days",{value:x(t.carbon_last7??0,e)})},{key:"points",label:e("home.stats.rewards"),value:`${d(t.total_points_awarded??0)} ${e("units.points")}`,accent:o[3],detail:e("home.stats.transactionsLast7",{value:c(t.transactions_last7??0)})}]},[s,e]),i=m.useMemo(()=>{if(!(s!=null&&s.generated_at))return null;const t=new Date(s.generated_at);return Number.isNaN(t.getTime())?null:t},[s==null?void 0:s.generated_at]),p=()=>a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:Array.from({length:4}).map((t,n)=>a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"mx-auto mb-3 h-8 w-24 animate-pulse rounded bg-gray-200"}),a.jsx("div",{className:"mx-auto h-4 w-20 animate-pulse rounded bg-gray-200"})]},`skeleton-${n}`))}),h=()=>a.jsx("div",{className:"rounded-md border border-red-200 bg-red-50 p-6 text-center text-sm text-red-600",children:e("home.stats.loadError")}),v=()=>a.jsx("div",{className:"space-y-12",children:a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:g.map((t,n)=>a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:`text-3xl font-bold mb-2 ${t.accent}`,children:t.value}),a.jsx("div",{className:"text-gray-600 text-sm font-medium",children:t.label}),t.detail&&a.jsx("div",{className:"mt-1 text-xs text-gray-400",children:t.detail})]},t.key))})});return a.jsx("section",{className:"py-16 px-4 bg-white",children:a.jsxs("div",{className:"max-w-7xl mx-auto",children:[r&&p(),!r&&l&&h(),!r&&!l&&v(),i&&a.jsx("div",{className:"mt-6 text-center text-xs text-gray-400",children:e("home.stats.updatedAt",{time:i.toLocaleString()})})]})})}export{w as default};
