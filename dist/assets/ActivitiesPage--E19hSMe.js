import{c as T,u as v,j as e,B as A,X as o,r as N,f as w}from"./index-BKjOfV5l.js";import{u as _,L as $}from"./useQuery-BKOf-XZE.js";import{I as g}from"./Input-CQCfPgps.js";import{C as F}from"./clock-CO_6aMIU.js";import{C as M}from"./circle-check-big-iU2hGy9Z.js";import{C as P}from"./circle-x-BZIamY_9.js";import{F as k}from"./funnel-Ch0r0Cl2.js";import{S as E}from"./search-B4M-0oqD.js";import{f as I,P as O}from"./Pagination-BlE9lgWV.js";import{E as z}from"./eye-CXemIeRw.js";import{A as R}from"./ActivityDetailModal-_pRVrJ-D.js";import{A as H,b as X,a as Q}from"./Alert-Tl0dtwbA.js";import{C as q}from"./circle-alert-IgYmallE.js";import"./Card-BjV_5Hz9.js";import"./image-CLrOna7A.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]],C=T("calendar-days",G);function J({filters:s,onFiltersChange:c,categories:l=[],isLoading:r=!1}){const{t:a}=v(),t=(i,p)=>{c({...s,[i]:p,page:1})},h=()=>{c({search:"",category:"",status:"",start_date:"",end_date:"",sort:"created_at_desc",page:1})},m=s.search||s.category||s.status||s.start_date||s.end_date,u=[{value:"pending",label:a("activities.status.pending"),icon:e.jsx(F,{className:"h-4 w-4 text-blue-500"})},{value:"approved",label:a("activities.status.approved"),icon:e.jsx(M,{className:"h-4 w-4 text-green-500"})},{value:"rejected",label:a("activities.status.rejected"),icon:e.jsx(P,{className:"h-4 w-4 text-red-500"})}],n=[{value:"created_at_desc",label:a("common.sort.newest")},{value:"created_at_asc",label:a("common.sort.oldest")},{value:"points_desc",label:a("common.sort.pointsHighToLow")},{value:"points_asc",label:a("common.sort.pointsLowToHigh")}];return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(k,{className:"h-5 w-5 text-gray-600"}),e.jsx("h3",{className:"text-lg font-semibold",children:a("activities.filters.title")})]}),m&&e.jsxs(A,{variant:"ghost",size:"sm",onClick:h,className:"text-gray-500 hover:text-gray-700",children:[e.jsx(o,{className:"h-4 w-4 mr-1"}),a("common.clear")]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("common.search")}),e.jsxs("div",{className:"relative",children:[e.jsx(E,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(g,{type:"text",value:s.search,onChange:i=>t("search",i.target.value),placeholder:a("activities.filters.searchPlaceholder"),className:"pl-10"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("activities.filters.category")}),e.jsxs("select",{value:s.category,onChange:i=>t("category",i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:r,children:[e.jsx("option",{value:"",children:a("activities.filters.allCategories")}),l.map(i=>e.jsx("option",{value:i.category,children:a(`activities.categories.${i.category}`,i.category)},i.category))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("activities.filters.status")}),e.jsxs("select",{value:s.status,onChange:i=>t("status",i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:r,children:[e.jsx("option",{value:"",children:a("activities.filters.allStatus")}),u.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))]})]})]}),e.jsxs("div",{className:"mt-4 grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(C,{className:"h-4 w-4 inline mr-1"}),a("activities.filters.startDate")]}),e.jsx(g,{type:"date",value:s.start_date,onChange:i=>t("start_date",i.target.value),className:"w-full"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(C,{className:"h-4 w-4 inline mr-1"}),a("activities.filters.endDate")]}),e.jsx(g,{type:"date",value:s.end_date,onChange:i=>t("end_date",i.target.value),className:"w-full"})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:a("common.sort.sortBy")}),e.jsx("select",{value:s.sort,onChange:i=>t("sort",i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-transparent",disabled:r,children:n.map(i=>e.jsx("option",{value:i.value,children:i.label},i.value))})]}),m&&e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-blue-700",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsxs("span",{children:[a("activities.filters.activeFilters"),":"]})]})}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[s.search&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:[a("common.search"),': "',s.search,'"',e.jsx("button",{onClick:()=>t("search",""),className:"ml-1 hover:text-blue-600",children:e.jsx(o,{className:"h-3 w-3"})})]}),s.category&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:[a(`activities.categories.${s.category}`,s.category),e.jsx("button",{onClick:()=>t("category",""),className:"ml-1 hover:text-blue-600",children:e.jsx(o,{className:"h-3 w-3"})})]}),s.status&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:[a(`activities.status.${s.status}`),e.jsx("button",{onClick:()=>t("status",""),className:"ml-1 hover:text-blue-600",children:e.jsx(o,{className:"h-3 w-3"})})]}),(s.start_date||s.end_date)&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:[s.start_date," - ",s.end_date,e.jsx("button",{onClick:()=>{t("start_date",""),t("end_date","")},className:"ml-1 hover:text-blue-600",children:e.jsx(o,{className:"h-3 w-3"})})]})]})]})]})}function K({activities:s,onRowClick:c}){const{t:l,formatNumber:r}=v(),a=t=>{switch(t){case"pending":return e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:[e.jsx(F,{className:"h-3 w-3 mr-1"})," ",l("activities.status.pending")]});case"approved":return e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(M,{className:"h-3 w-3 mr-1"})," ",l("activities.status.approved")]});case"rejected":return e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-red-100 text-red-800",children:[e.jsx(P,{className:"h-3 w-3 mr-1"})," ",l("activities.status.rejected")]});default:return null}};return e.jsx("div",{className:"overflow-x-auto bg-white rounded-lg shadow-sm border",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:l("activities.table.activity")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:l("activities.table.data")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:l("activities.table.carbonSaved")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:l("activities.table.points")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:l("activities.table.status")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:l("activities.table.date")}),e.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:l("activities.table.actions")})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:s.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.activity_name}),e.jsx("div",{className:"text-sm text-gray-500",children:l(`activities.categories.${t.activity_category}`,t.activity_category)})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[r(t.data_value)," ",l(`units.${t.activity_unit}`,t.activity_unit)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-gray-900",children:[r(t.carbon_saved)," kg CO2e"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"text-sm text-green-600 font-semibold",children:["+",r(t.points_earned)]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:a(t.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:I(new Date(t.activity_date),"yyyy-MM-dd")}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:e.jsxs(A,{variant:"ghost",size:"sm",onClick:()=>c(t),children:[e.jsx(z,{className:"h-4 w-4 mr-1"})," ",l("common.view")]})})]},t.id))})]})})}function oe(){var y,b,f;const{t:s}=v(),[c,l]=N.useState({search:"",category:"",status:"",start_date:"",end_date:"",sort:"created_at_desc",page:1,limit:10}),[r,a]=N.useState(null),{data:t,isLoading:h,error:m,isFetching:u}=_(["activities",c],()=>w.get("/activities",{params:c}),{keepPreviousData:!0}),{data:n}=_("activityCategories",()=>w.get("/activities/categories")),i=d=>{l(d)},p=d=>{l(L=>({...L,page:d}))},S=d=>{a(d)},D=()=>{a(null)},j=((y=t==null?void 0:t.data)==null?void 0:y.data)||[],x=((b=t==null?void 0:t.data)==null?void 0:b.pagination)||{},B=((f=n==null?void 0:n.data)==null?void 0:f.data)||[];return e.jsxs("div",{className:"container mx-auto py-8 px-4",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:s("activities.history.title")}),e.jsx("p",{className:"text-muted-foreground",children:s("activities.history.subtitle")})]}),e.jsx(J,{filters:c,onFiltersChange:i,categories:B,isLoading:u}),h?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx($,{className:"h-8 w-8 animate-spin text-green-500"})}):m?e.jsxs(H,{variant:"destructive",children:[e.jsx(q,{className:"h-4 w-4"}),e.jsx(X,{children:s("common.error")}),e.jsx(Q,{children:s("errors.loadFailed")})]}):j.length===0?e.jsxs("div",{className:"text-center py-16 bg-white rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-xl font-semibold",children:s("activities.history.noActivitiesFound")}),e.jsx("p",{className:"text-muted-foreground mt-2",children:s("activities.history.tryDifferentFilters")})]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{activities:j,onRowClick:S}),e.jsx(O,{currentPage:x.current_page,totalPages:x.total_pages,onPageChange:p,itemsPerPage:x.per_page,totalItems:x.total_items})]}),e.jsx(R,{activity:r,isOpen:!!r,onClose:D})]})}export{oe as default};
