import{c as Z,u as te,r as i,j as e,B,y as ie,I as ee,b as U,S as ve,p as se,C as Q,z as be,a as Y,X as Ne}from"./index-CxlEKgNF.js";import{C as P,a as O,b as q,d as M,c as H}from"./Card-DsPqWPjY.js";import{F as ye}from"./funnel-DtXHJdq2.js";import{u as we}from"./index.esm-HJ9Q04k3.js";import{b as _e}from"./r2Upload-CjTIP0dQ.js";import{A as de,a as me}from"./Alert-Cwzl71iv.js";import{U as ne}from"./upload-BFlC-BZ0.js";import{C as ce}from"./circle-check-big-B5TyGFs6.js";import{A as Se}from"./arrow-left-CfFcQ9-a.js";/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],ke=Z("calendar",Ce);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]],le=Z("car",Ae);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fe=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],De=Z("file-text",Fe);/**
 * @license lucide-react v0.510.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M7 19H4.815a1.83 1.83 0 0 1-1.57-.881 1.785 1.785 0 0 1-.004-1.784L7.196 9.5",key:"x6z5xu"}],["path",{d:"M11 19h8.203a1.83 1.83 0 0 0 1.556-.89 1.784 1.784 0 0 0 0-1.775l-1.226-2.12",key:"1x4zh5"}],["path",{d:"m14 16-3 3 3 3",key:"f6jyew"}],["path",{d:"M8.293 13.596 7.196 9.5 3.1 10.598",key:"wf1obh"}],["path",{d:"m9.344 5.811 1.093-1.892A1.83 1.83 0 0 1 11.985 3a1.784 1.784 0 0 1 1.546.888l3.943 6.843",key:"9tzpgr"}],["path",{d:"m13.378 9.633 4.096 1.098 1.097-4.096",key:"1oe83g"}]],oe=Z("recycle",ze),Ie={daily:U,transport:le,consumption:ve,environmental:oe,lifestyle:U,energy:U,water:U,waste:oe,travel:le};function Le({onActivitySelect:a,selectedActivity:m}){const{t:o,currentLanguage:j}=te(),[S,r]=i.useState([]),[C,N]=i.useState([]),[z,I]=i.useState([]),[f,w]=i.useState("all"),[y,F]=i.useState(""),[v,k]=i.useState(!0),[L,D]=i.useState("");i.useEffect(()=>{(async()=>{var c,p,g;try{k(!0);const u=await se.getActivities();if((c=u==null?void 0:u.data)!=null&&c.success){const d=(p=u==null?void 0:u.data)==null?void 0:p.data,T=(Array.isArray(d==null?void 0:d.activities)?d.activities:Array.isArray(d)?d:[]).filter(h=>!(!h||h.deleted_at||Object.prototype.hasOwnProperty.call(h,"is_active")&&h.is_active===!1)).map(h=>({...h,carbon_factor:Number(h.carbon_factor??h.factor??0),sort_order:Number(h.sort_order??0)})).sort((h,W)=>{const X=(h.sort_order??0)-(W.sort_order??0);return X!==0?X:(h.name_zh||"").localeCompare(W.name_zh||"")});r(T),N(T);const A=Array.isArray(d==null?void 0:d.categories)?d.categories:[...new Set(T.map(h=>h.category).filter(Boolean))];I(A)}else D(((g=u==null?void 0:u.data)==null?void 0:g.message)||o("errors.loadFailed"))}catch(u){D(u.message||o("errors.network"))}finally{k(!1)}})()},[o]),i.useEffect(()=>{let s=S;if(f!=="all"&&(s=s.filter(c=>c.category===f)),y){const c=(y||"").toString().toLowerCase(),p=g=>(g??"").toString().toLowerCase();s=s.filter(g=>p(g.name_zh).includes(c)||p(g.name_en).includes(c)||p(g.description_zh).includes(c)||p(g.description_en).includes(c))}N(s)},[S,f,y]);const $=s=>{a(s)},R=s=>o(`activities.categories.${s}`)||s,E=s=>(j||"").toLowerCase().startsWith("en")?s.name_en||s.name_zh||s.name:s.name_zh||s.name_en||s.name,l=s=>(j||"").toLowerCase().startsWith("en")?s.description_en||s.description_zh||s.description:s.description_zh||s.description_en||s.description;return v?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500"}),e.jsx("span",{className:"ml-2 text-gray-600",children:o("common.loading")})]}):L?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-600 mb-4",children:L}),e.jsx(B,{onClick:()=>window.location.reload(),children:o("common.retry")})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ie,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(ee,{type:"text",placeholder:o("activities.searchPlaceholder"),value:y,onChange:s=>F(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4 text-gray-400"}),e.jsxs("select",{value:f,onChange:s=>w(s.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500",children:[e.jsx("option",{value:"all",children:o("activities.categories.all")}),z.map(s=>e.jsx("option",{value:s,children:R(s)},s))]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:C.map(s=>{const c=Ie[s.category]||U,p=(m==null?void 0:m.id)||(m==null?void 0:m.uuid),g=s.id||s.uuid,u=p&&g&&p===g;return e.jsxs(P,{className:`cursor-pointer transition-all duration-200 hover:shadow-md ${u?"ring-2 ring-green-500 bg-green-50":"hover:bg-gray-50"}`,onClick:()=>$(s),children:[e.jsx(O,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${u?"bg-green-200":"bg-gray-100"}`,children:e.jsx(c,{className:`h-5 w-5 ${u?"text-green-700":"text-gray-600"}`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx(q,{className:"text-sm font-medium",children:E(s)}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:R(s.category)})]})]})}),e.jsxs(M,{className:"pt-0",children:[e.jsx(H,{className:"text-sm text-gray-600 mb-3",children:l(s)}),e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsxs("div",{className:"text-gray-500",children:[o("activities.unit"),": ",o(`units.${s.unit}`,s.unit)]}),e.jsxs("div",{className:"text-green-600 font-medium",children:[s.carbon_factor," ",o("activities.carbonFactor")]})]}),s.points_per_unit&&e.jsxs("div",{className:"mt-2 text-xs text-blue-600",children:[s.points_per_unit," ",o("activities.pointsPerUnit")]})]})]},g)})}),C.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"text-gray-400 mb-2",children:e.jsx(ie,{className:"h-12 w-12 mx-auto"})}),e.jsx("p",{className:"text-gray-600",children:o("activities.noActivitiesFound")}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:o("activities.tryDifferentSearch")})]})]})}function Re({activity:a,onCalculate:m,onSubmit:o,calculationResult:j,isSubmitting:S}){const{t:r,currentLanguage:C}=te(),[N,z]=i.useState([]),[I,f]=i.useState(""),[w,y]=i.useState(!1),[F,v]=i.useState([]),[k,L]=i.useState([]),[D,$]=i.useState({done:0,total:0}),[R,E]=i.useState(!1),[l,s]=i.useState(!1),c=i.useRef(null),{register:p,handleSubmit:g,watch:u,formState:{errors:d}}=we({defaultValues:{activity_date:new Date().toISOString().split("T")[0],description:""}}),J=u("data"),T=i.useRef(""),A=i.useRef(null);i.useEffect(()=>{const t=(a==null?void 0:a.id)||(a==null?void 0:a.uuid)||"",n=J;A.current&&(clearTimeout(A.current),A.current=null);const b=parseFloat(n);if(!t||!n||isNaN(b)||b<=0){E(!1);return}return A.current=setTimeout(()=>{const x=`${t}::${b}`;if(T.current===x){E(!0);return}T.current=x,m(b),E(!0)},300),()=>{A.current&&(clearTimeout(A.current),A.current=null)}},[a,J,m]);const h=async t=>{if(f(""),!N.length&&!F.length){f(r("activities.form.imageRequired")||"请至少选择一张图片");return}let n=F;if(!F.length&&N.length){try{y(!0);const x=N.length;$({done:0,total:x}),n=(await _e(N,{directory:"activities",entityType:"carbon_record"},(_,K)=>{$({done:_,total:K})})).map(_=>({url:_.url,file_path:_.file_path,original_name:_.original_name,mime_type:_.mime_type,size:_.size})),v(n)}catch(x){f(x.message||"上传失败"),y(!1);return}y(!1)}const b={activity_id:a.id||a.uuid,amount:parseFloat(t.data),date:t.activity_date,description:t.description,images:(n||[]).map(x=>({url:x.url,file_path:x.file_path,original_name:x.original_name,mime_type:x.mime_type,size:x.size}))};o(b)},W=t=>{f("");const n=5,b=5*1024*1024,x=[...N],G=[...k];if(x.length+t.length>n){f(r("activities.form.maxFilesReached")||"最多只能上传 5 张图片");return}const _=[],K=[];for(const V of t){if(V.size>b){f(r("activities.form.fileTooLarge")||"文件过大");continue}x.some(re=>re.name===V.name&&re.size===V.size)||(_.push(V),K.push(URL.createObjectURL(V)))}z([...x,..._]),L([...G,...K])},X=t=>{const n=Array.from(t.target.files||[]);W(n),t.target.value=null},xe=t=>{t.preventDefault(),t.stopPropagation(),s(!0)},ue=t=>{t.preventDefault(),t.stopPropagation(),s(!1)},he=t=>{t.preventDefault(),t.stopPropagation(),s(!1);const n=Array.from(t.dataTransfer.files||[]);W(n)},ge=()=>{var t;(t=c.current)==null||t.click()},fe=t=>{z(n=>n.filter((b,x)=>x!==t)),L(n=>{const b=n.filter((x,G)=>G!==t);return n[t]&&URL.revokeObjectURL(n[t]),b})};if(!a)return e.jsx(P,{children:e.jsxs(M,{className:"py-12 text-center",children:[e.jsx(Q,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:r("activities.selectActivityFirst")})]})});const pe=t=>(C||"").toLowerCase().startsWith("en")?t.name_en||t.name_zh||t.name:t.name_zh||t.name_en||t.name,je=t=>(C||"").toLowerCase().startsWith("en")?t.description_en||t.description_zh||t.description:t.description_zh||t.description_en||t.description,ae=R&&j?e.jsxs(P,{className:"bg-green-50 border-green-200 shadow-sm",children:[e.jsxs(O,{className:"pb-3",children:[e.jsx(q,{className:"text-sm font-medium text-green-800",children:r("activities.form.calculationResult")}),e.jsx(H,{className:"text-xs",children:r("activities.form.previewAutoUpdate")||"实时预览"})]}),e.jsx(M,{className:"pt-0",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border",children:[e.jsxs("div",{className:"text-xs text-gray-500 mb-1",children:[r("activities.carbonSaved")," (kg CO₂)"]}),e.jsx("div",{className:"text-2xl font-bold text-green-600 leading-none",children:(()=>{const t=j.carbon_saved,n=typeof t=="number"?t:Number(t);return Number.isFinite(n)?n.toFixed(2):"0.00"})()})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border",children:[e.jsx("div",{className:"text-xs text-gray-500 mb-1",children:r("activities.form.expectedPoints")}),e.jsx("div",{className:"text-2xl font-bold text-blue-600 leading-none",children:j.points_earned??0})]})]})})]}):null;return e.jsxs("div",{className:"space-y-6 md:space-y-0 md:grid md:grid-cols-12 md:gap-6",children:[e.jsxs("div",{className:"md:col-span-8 space-y-6",children:[e.jsxs(P,{children:[e.jsxs(O,{children:[e.jsxs(q,{className:"flex items-center gap-2",children:[e.jsx(be,{className:"h-5 w-5 text-green-600"}),pe(a)]}),e.jsx(H,{children:je(a)})]}),e.jsx(M,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500",children:[r("activities.category"),":"]}),e.jsx("div",{className:"font-medium",children:r(`activities.categories.${a.category}`)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500",children:[r("activities.unit"),":"]}),e.jsx("div",{className:"font-medium",children:r(`units.${a.unit}`,a.unit)})]}),e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500",children:[r("activities.carbonFactor"),":"]}),e.jsx("div",{className:"font-medium text-green-600",children:a.carbon_factor})]}),a.points_per_unit&&e.jsxs("div",{children:[e.jsxs("span",{className:"text-gray-500",children:[r("activities.pointsPerUnit"),":"]}),e.jsx("div",{className:"font-medium text-blue-600",children:a.points_per_unit})]})]})})]}),e.jsx("div",{className:"md:hidden",children:ae}),e.jsxs(P,{children:[e.jsxs(O,{children:[e.jsx(q,{children:r("activities.form.dataInput")}),e.jsx(H,{children:r("activities.form.inputDescription")})]}),e.jsx(M,{children:e.jsxs("form",{onSubmit:g(h),className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[r("activities.form.dataValue")," (",r(`units.${a.unit}`,a.unit),")"]}),e.jsx(ee,{type:"number",step:"0.01",min:"0",placeholder:r("activities.form.dataPlaceholder"),error:d.data,...p("data",{required:r("activities.form.dataRequired"),min:{value:.01,message:r("activities.form.dataMinimum")}})}),d.data&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.data.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ke,{className:"inline h-4 w-4 mr-1"}),r("activities.form.activityDate")]}),e.jsx(ee,{type:"date",max:new Date().toISOString().split("T")[0],error:d.activity_date,...p("activity_date",{required:r("activities.form.dateRequired")})}),d.activity_date&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.activity_date.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(De,{className:"inline h-4 w-4 mr-1"}),r("activities.form.notes")]}),e.jsx("textarea",{rows:4,placeholder:r("activities.form.notesPlaceholder"),className:`flex w-full rounded-md border bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 ${d.description?"border-red-500 focus-visible:ring-red-500":"border-input ring-offset-background"}`,...p("description",{maxLength:{value:500,message:r("validation.maxLength",{max:500})}})}),d.description&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:d.description.message})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(ne,{className:"inline h-4 w-4 mr-1"}),r("activities.form.uploadImage")]}),e.jsxs("div",{className:Y("border-2 border-dashed rounded-lg p-6 flex flex-col items-center justify-center gap-3 transition-all duration-200 cursor-pointer",l?"border-green-500 bg-green-50 scale-[1.02]":"border-gray-300 hover:border-green-400 hover:bg-gray-50",I?"border-red-300 bg-red-50":""),onDragOver:xe,onDragLeave:ue,onDrop:he,onClick:ge,children:[e.jsx("input",{ref:c,type:"file",accept:"image/*",multiple:!0,onChange:X,className:"hidden"}),e.jsx("div",{className:Y("p-3 rounded-full transition-colors",l?"bg-green-100":"bg-gray-100"),children:e.jsx(ne,{className:Y("h-6 w-6",l?"text-green-600":"text-gray-500")})}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:l?r("activities.form.dropHere")||"释放以上传":r("activities.form.clickOrDrag")||"点击或拖拽上传图片"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:r("activities.form.uploadHint")||"支持 JPG, PNG (最大 5MB)"})]})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[N.length>0&&e.jsx("ul",{className:"space-y-2 text-sm",children:N.map((t,n)=>e.jsxs("li",{className:"flex items-center justify-between bg-gray-50 px-3 py-2 rounded-md border border-gray-200 hover:border-gray-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0",children:[k[n]&&e.jsx("img",{src:k[n],alt:t.name,className:"h-10 w-10 object-cover rounded border border-gray-200"}),e.jsxs("div",{className:"flex flex-col min-w-0",children:[e.jsx("span",{className:"truncate font-medium text-gray-700",children:t.name}),e.jsxs("span",{className:"text-xs text-gray-500",children:[(t.size/1024).toFixed(1)," KB"]})]})]}),e.jsx("button",{type:"button",onClick:b=>{b.stopPropagation(),fe(n)},className:"p-1 text-gray-400 hover:text-red-500 hover:bg-red-50 rounded-full transition-colors",children:e.jsx(Ne,{className:"h-4 w-4"})})]},n))}),w&&e.jsxs("div",{className:"text-xs text-blue-600 flex items-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-2 border-blue-600 border-t-transparent"}),r("common.uploading")||"正在上传..."," ",D.total>0?`${D.done}/${D.total}`:""]}),I&&e.jsxs("p",{className:"text-xs text-red-600 flex items-center gap-1",children:[e.jsx(Q,{className:"h-3 w-3"}),I]})]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx(B,{type:"submit",className:"flex-1",loading:S||w,disabled:S||w||!R,children:S||w?r("activities.form.submitting")||"提交中...":r("activities.form.submit")}),e.jsx(B,{type:"button",variant:"outline",onClick:()=>window.location.reload(),children:r("common.reset")})]}),e.jsxs(de,{variant:"info",children:[e.jsx(Q,{className:"h-4 w-4"}),e.jsx(me,{children:r("activities.form.submitHint")})]})]})})]})]}),e.jsx("div",{className:"hidden md:block md:col-span-4",children:e.jsx("div",{className:"sticky top-20 space-y-4",children:ae||e.jsxs(P,{className:"border-dashed",children:[e.jsxs(O,{className:"pb-3",children:[e.jsx(q,{className:"text-sm text-gray-600",children:r("activities.form.calculationResult")}),e.jsx(H,{className:"text-xs",children:r("activities.form.enterDataToPreview")||"输入数值后出现"})]}),e.jsx(M,{className:"text-xs text-gray-400",children:r("activities.form.previewPlaceholder")||"填写数据以查看实时计算"})]})})})]})}function Ee(){const{t:a}=te(),[m,o]=i.useState(1),[j,S]=i.useState(null),[r,C]=i.useState(null),[N,z]=i.useState(!1),[I,f]=i.useState(!1),[w,y]=i.useState(null),[F,v]=i.useState(""),k=[{id:1,title:a("activities.form.selectActivity"),description:a("activities.form.selectActivityDesc")},{id:2,title:a("activities.form.dataInput"),description:a("activities.form.dataInputDesc")},{id:3,title:a("activities.form.submit"),description:a("activities.form.submitDesc")}],L=l=>{S(l),C(null),v(""),o(2)},D=i.useCallback(async l=>{if(j){z(!0),v("");try{const s=j.id||j.uuid,c=await se.calculate(s,l);c.data.success?C(c.data.data):v(c.data.message||a("activities.form.calculationFailed"))}catch(s){const c=(s==null?void 0:s.message)||"";if((s==null?void 0:s.code)==="ERR_CANCELED"||/aborted|canceled/i.test(c))return;v(c||a("activities.form.calculationFailed"))}finally{z(!1)}}},[j,a]),$=async l=>{f(!0),v("");try{const s=await se.recordActivity({...l});if(s.data.success){const c=s.data.calculation||{};y({carbon_saved:c.carbon_saved||0,points_earned:c.points_earned||0,record_id:s.data.record_id}),o(3)}else v(s.data.message||a("activities.form.submitFailed"))}catch(s){v(s.message||a("activities.form.submitFailed"))}finally{f(!1)}},R=()=>{o(1),S(null),C(null),y(null),v("")},E=()=>{m>1&&(o(m-1),v(""))};return e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4",children:e.jsx(U,{className:"w-8 h-8 text-green-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:a("activities.title")}),e.jsx("p",{className:"text-gray-600",children:a("activities.description")})]}),e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex items-center justify-between",children:k.map((l,s)=>e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 ${m>=l.id?"bg-green-600 border-green-600 text-white":"border-gray-300 text-gray-500"}`,children:m>l.id?e.jsx(ce,{className:"w-6 h-6"}):e.jsx("span",{className:"text-sm font-medium",children:l.id})}),e.jsxs("div",{className:"ml-3 hidden sm:block",children:[e.jsx("div",{className:`text-sm font-medium ${m>=l.id?"text-green-600":"text-gray-500"}`,children:l.title}),e.jsx("div",{className:"text-xs text-gray-500",children:l.description})]}),s<k.length-1&&e.jsx("div",{className:`flex-1 h-0.5 mx-4 ${m>l.id?"bg-green-600":"bg-gray-300"}`})]},l.id))})}),F&&e.jsx(de,{variant:"destructive",className:"mb-6",children:e.jsx(me,{children:F})}),e.jsxs("div",{className:"space-y-6",children:[m===1&&e.jsx(Le,{onActivitySelect:L,selectedActivity:j}),m===2&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(B,{variant:"outline",onClick:E,className:"flex items-center gap-2",children:[e.jsx(Se,{className:"w-4 h-4"}),a("common.back")]}),e.jsx("div",{className:"text-sm text-gray-600",children:a("activities.form.step2Of3")})]}),e.jsx(Re,{activity:j,onCalculate:D,onSubmit:$,calculationResult:r,isCalculating:N,isSubmitting:I})]}),m===3&&w&&e.jsxs(P,{className:"bg-green-50 border-green-200",children:[e.jsxs(O,{className:"text-center",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-green-100 rounded-full mb-4 mx-auto",children:e.jsx(ce,{className:"w-8 h-8 text-green-600"})}),e.jsx(q,{className:"text-green-800",children:a("activities.form.submitSuccess")}),e.jsx(H,{children:a("activities.form.submitSuccessDesc")})]}),e.jsxs(M,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(()=>{const l=w.carbon_saved,s=typeof l=="number"?l:Number(l);return Number.isFinite(s)?s.toFixed(2):"0.00"})()}),e.jsxs("div",{className:"text-sm text-gray-600",children:[a("activities.carbonSaved")," (kg CO₂)"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:w.points_earned||0}),e.jsx("div",{className:"text-sm text-gray-600",children:a("activities.pointsEarned")})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:a("activities.status.pending")}),e.jsx("div",{className:"text-sm text-gray-600",children:a("activities.currentStatus")})]})]}),e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-sm text-gray-600",children:a("activities.form.reviewNotice")}),e.jsxs("div",{className:"flex gap-4 justify-center",children:[e.jsx(B,{onClick:R,children:a("activities.form.recordAnother")}),e.jsx(B,{variant:"outline",onClick:()=>window.location.href="/dashboard",children:a("activities.form.goToDashboard")})]})]})]})]})]})]})}function We(){return e.jsx(Ee,{})}export{We as default};
